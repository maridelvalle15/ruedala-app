{% extends "base.html" %}
{# Load the tag library #}
{% load bootstrap3 %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% load static %}

{% block extracss %}
<style type="text/css">
    #titulo-login {
        font-family: Arial;
        font-size: 29px;
        color: #B5B6B8;
    }
    @media only screen and (max-width: 435px) {
        #titulo-login {
            font-family: Arial;
            font-size: 15px;
            color: #B5B6B8;
        }
    }
    #link-acerta {
        color: #ED673B;
    }
    input:focus {
        border-color: #ED673B !important;
        color: #ED673B !important;
    }
    input:focus::-webkit-input-placeholder {
        color: #ED673B !important;
    }
    input:focus::-moz-placeholder {
        color: #ED673B !important;
    }
    input:focus:-moz-placeholder {
        color: #ED673B !important;
    }
    input:focus:-ms-input-placeholder {
        color: #ED673B !important;
    }

    .login-box-body {
        margin-left: 20%;
        margin-right: 20%
    }
    .calculate {
        color: #FFFFFF;
        background-color: #727270;
        text-align: center;
    }
    .calculate {
      transition: all 0.8s ease;
    }
    .calculate:hover {
      background: #82C539;
      color: #FFFFFF;
    }
    .local {
        color: #FFFFFF;
        background-color: #727270;
        text-align: center;
    }
    .local {
      transition: all 0.8s ease;
    }
    .local:hover {
      background: #82C539;
      color: #FFFFFF;
    }
    .address {
        color: #FFFFFF;
        background-color: #727270;
        text-align: center;
    }
    .address {
      transition: all 0.8s ease;
    }
    .address:hover {
      background: #ED673B;
      color: #FFFFFF;
    }
    .box.box-danger {
    border-top-color: #82C539;
	}
    .first {
        padding-top: 10%;
    }
    @media only screen and (max-width: 435px) {
        .first {
          padding-top: 20%;
        }
    }
    .form-group.has-error label {
    	color: #D16153;
	}
	.form-group.has-error .form-control {
    	border-color: #D16153;
	}
</style>
<style>
  #map {
    height: 100%;
  }
</style>
{% endblock extracss %}

{% block content %}
<div class="row" style="margin-top: 10%;">
    <div class="col-xs-12">
        <div class="row">
            <div class="col-sm-hidden col-xs-hidden col-md-2">
                <!--<p>Click the button to get your coordinates.</p>

                <button onclick="getLocation()">Try It</button>

                <p id="demo"></p>
                -->
            </div>
            <div class="col-xs-12 col-sm-12 col-md-8">
                <div class="box box-danger">
                    <div class="box-header with-border">
                        <div class="col-xs-10 col-xs-push-1">
                            <h1 id="titulo-login" class="text-center"><strong>REGISTRAR COMERCIO</strong></h1>
                            <h5 class="text-center"> Por favor llene los siguientes datos para registrar su comercio. </h5>
                            <h5 class="text-center"> ** Es IMPORTANTE que para un óptimo registro, especifique la ciudad y país en la dirección del comercio. </h5>
                            </div>
                            <!--
                            <h5 class="text-center"> Preferiblemente, sitúese frente a su comercio para realizar el registro.</h5>
                            <h5 class="text-center"> En ese caso, presione el siguiente botón.
                            <button class="btn local">Agregar localización</button></h5>
                            <div class="col-xs-12 col-xs-push-4 localizacion" style="display:none;">
                                <p>Latitud: <span class="calc-lat"></span></p>
                                <p>Longitud: <span class="calc-long"></span></p>
                            </div>
                            -->
                            <!--
                            <h5 class="text-center"> En caso contrario, agregue la dirección de su comercio.
                            <button class="btn address">Agregar dirección</button></h5>
                            <div class="col-xs-12 direccion" style="display:none;">
                                <form action="" method="post" role="form" class="form-horizontal">
                                    {% bootstrap_field form.direccion layout='horizontal' %}
                                </form>
                            </div>
                            -->
                        </div>
                    </div>
                    <div class="box-body">
                        <div class="col-md-1"></div>
                        <div class="col-md-10">
                            <div class="hidden">
                                {% bootstrap_form_errors form %}
                            </div>
                            <form action="" method="post" role="form" class="form-horizontal" enctype="multipart/form-data">
                                {% csrf_token %}
                                <h2 id="titulo-login" class="text-center"><strong>Información de la Empresa</strong></h2>
                            {% bootstrap_field form.nombre layout='horizontal' %}
                            {% bootstrap_field form.razon layout='horizontal' %}
                            {% bootstrap_field form.RUC layout='horizontal' %}
                            {% bootstrap_field form.telefono1 layout='horizontal' %}
                            {% bootstrap_field form.telefono2 layout='horizontal' %}
                            {% bootstrap_field form.email layout='horizontal' %}
                            {% bootstrap_field form.direccion layout='horizontal' %}
                            <div id="map" style="border: solid 1px #aaa; min-height: 250px;"></div>
                            <h2 id="titulo-login" class="text-center"><strong>Información del Representante Legal</strong></h2>
                            {% bootstrap_field form.nombre_rl layout='horizontal' %}
                            {% bootstrap_field form.apellido_rl layout='horizontal' %}
                            {% bootstrap_field form.cedula_rl layout='horizontal' %}
                            {% bootstrap_field form.telefono_rl layout='horizontal' %}
                            {% bootstrap_field form.email_rl layout='horizontal' %}
                            {% bootstrap_field form.nombre_extra layout='horizontal' %}
                            {% bootstrap_field form.telefono_extra layout='horizontal' %}
                            {% bootstrap_field form.correo_extra layout='horizontal' %}
                            <h2 id="titulo-login" class="text-center"><strong>Beneficio para los Clientes y Colaboradores</strong></h2>
                            {% bootstrap_field form.programa_beneficios layout='horizontal' %}
                            {% bootstrap_field form.beneficios layout='horizontal' %}
                            {% bootstrap_field form.disclaimer layout='horizontal' %}
                            {% bootstrap_field form.disc_long layout='horizontal' %}
                            {% bootstrap_field form.img_front layout='horizontal' %}
                            {% bootstrap_field form.img_inside layout='horizontal' %}
                            {% bootstrap_field form.desea_pos layout='horizontal' %}
                                {% buttons %}
                                    <div class="col-md-3"></div>
                                    <div class="col-sm-4 col-md-6 text-center">
                                        <button id="id_submit" type="submit" class="btn btn-lg calculate">
                                            ENVIAR
                                        </button>
                                        <br>
                                        <br>
                                    </div>
                                    <div class="col-md-3"></div>
                                {% endbuttons %}
                            </form>
                        </div>
                        <div class="col-md-1"></div>
                    </div><!-- /.box-body -->
                </div><!-- /.box -->
            </div>
            <div class="col-sm-hidden col-xs-hidden col-md-2"></div>
        </div>
    </div>
</div>
{% endblock content %}
{% block custom_script %}
<script>
// Note: This example requires that you consent to location sharing when
// prompted by your browser. If you see the error "The Geolocation service
// failed.", it means you probably did not give permission for the browser to
// locate you.

    function initMap() {
      var map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: -34.397, lng: 150.644},
        zoom: 10
      });
      var infoWindow = new google.maps.InfoWindow({map: map});

      // Try HTML5 geolocation.
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var pos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
          var geocoder = new google.maps.Geocoder;
          geocoder.geocode({'location': pos}, function(results, status) {
            if (status === 'OK') {
              if (results[1]) {
                map.setZoom(10);
                var marker = new google.maps.Marker({
                  position: pos,
                  map: map
                });
                infoWindow.setContent(results[1].formatted_address);
                infoWindow.open(map, marker);
                $("#id_direccion").val(results[1].formatted_address);
              } else {
                window.alert('No results found');
              }
            } else {
              window.alert('Geocoder failed due to: ' + status);
            }
          });
          map.setCenter(pos);
        }, function() {
          handleLocationError(true, infoWindow, map.getCenter());
        });
      } else {
        // Browser doesn't support Geolocation
        handleLocationError(false, infoWindow, map.getCenter());
      }
    }

    function handleLocationError(browserHasGeolocation, infoWindow, pos) {
      infoWindow.setPosition(pos);
      infoWindow.setContent(browserHasGeolocation ?
                            'Error: The Geolocation service failed.' :
                            'Error: Your browser doesn\'t support geolocation.');
    }

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAzbhW1t-vpJ4hNqlL0-93ynvPtn1OrW3k&signed_in=true&callback=initMap"
    async defer>
</script>

{% endblock custom_script %}
